" Functional settings
" -------------------

set nocompatible    " We're not vi, bitch
set history=1000    " Remember lots of commands
set mouse=a         " Mouse support

" Restore previous cursor position
" --------------------------------

au BufReadPost * if line("'\"") > 1 && line("'\"") <= line("$") | exe "normal! g`\"" | endif

" Indenting
" ---------

filetype indent on
set autoindent                    " Auto-indent
set smartindent                   " Smart indent
set noexpandtab                   " Tabbed indent
set copyindent preserveindent     " Preserve indent structure
set softtabstop=0                 " No spaces when tabbing
set shiftwidth=2                  " Two characters wide when using >> and stuff
set tabstop=2                     " Tabs count for 2 spaces

" Searching
" ---------

set ignorecase    " Ignore case when searching...
set smartcase     " ...unless there are caps.
set incsearch     " Incremental search
set hlsearch      " Highlight matches

" Undo
" ----

set ul=1000                   " Undo level
set undodir=~/.vim/backups    " Save undo history
set undofile

" File management
" ---------------

nmap <silent> <c-n> :NERDTreeToggle<CR>    " NERD tree mapping on C-n
set wildmenu                               " Autocomplete mapping
set wildmode=list:longest,full
set wildignore=*.o,*.obj,*~
set wildignore+=*vim/backups*
set wildignore+=*sass-cache*
set wildignore+=*DS_Store*
set wildignore+=vendor/rails/**
set wildignore+=vendor/cache/**
set wildignore+=*.gem
set wildignore+=log/**
set wildignore+=tmp/**
set wildignore+=*.png,*.jpg,*.gif
set wildignore+=*.zip,*.tar.gz,*.tar.bz2,*.rar,*.tar.xz
set wildignore+=*.o,*.out,*.obj,.git,*.rbc,*.class,.svn,*.gem

" Language-specific
" -----------------

filetype on
filetype plugin on

autocmd! BufRead,BufNewFile *.less set filetype=less " LESS
autocmd BufNewFile,BufRead *.rss setfiletype xml     " RSS is XML
au BufRead,BufNewFile *.{md,markdown,mdown,mkd,mkdn,txt} setf markdown " Markdown
au BufNewFile,BufRead *.json set ft=javascript " JSON is JavaScript

" Project-specific
" ----------------

" UniversityNow
autocmd BufNewFile,BufRead */unow-web/*.rb set et sw=2 ts=2
autocmd BufNewFile,BufRead */unow-web/*.{scss,js} set et shiftwidth=4 tabstop=4

" Visual
" ------

syntax on                 " Syntax highlighting on
set t_Co=256              " Have 256 colors
colorscheme jellybeans    " Color scheme
set ruler                 " Highlight cursor position
set cul                   " Highlight current line
set number                " Show line numbers
set showmatch             " Show matching bracket when you hover on one
set wrap                  " Soft wrap by word
  set linebreak
  set nolist
  set textwidth=0
  set wrapmargin=0
set scrolloff=4           " Scroll 4 lines away from margins
" set colorcolumn=81        " Non-strict 80-character wall

" Plugin-specific
" ---------------

let g:indent_guides_enable_on_vim_startup=1    " Start the Indent Guides plugin

" MacVim/gvim
" -----------

if has('gui_running')
  set gfn=Inconsolata:h16    " Font: 16pt Inconsolata
  set guioptions-=T          " Hide toolbar
  set clipboard=unnamed      " Use the system clipboard
end
